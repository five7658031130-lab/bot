"""
WINDOWS INSTALLATION & SETUP GUIDE
Advanced Music Bot for Windows
"""

# Step 1: Prerequisites
## Required Software:
- Python 3.8+ (Download from https://www.python.org/downloads/)
  âœ“ During installation, CHECK "Add Python to PATH"
- Git (Optional, for cloning the repo)
- FFmpeg (For audio processing)

# Step 2: FFmpeg Installation on Windows

## Option A: Using Chocolatey (Recommended if installed)
```
choco install ffmpeg -y
```

## Option B: Using Winget (Windows 10.1+)
```
winget install FFmpeg.FFmpeg
```

## Option C: Manual Installation
1. Download from https://ffmpeg.org/download.html
2. Extract to C:\ffmpeg
3. Add C:\ffmpeg\bin to your system PATH:
   - Press Win+X â†’ System â†’ Advanced system settings
   - Environment Variables â†’ New (under System variables)
   - Variable name: Path
   - Variable value: C:\ffmpeg\bin

# Step 3: Clone/Download Project

## Using Git:
```
git clone https://github.com/yourusername/MusicStreamer.git
cd MusicStreamer
```

## Or Download manually:
- Download ZIP file
- Extract to your desired location

# Step 4: Create .env File (Optional but Recommended)

Create a file named `.env` in the project root:

```
API_ID=28807899
API_HASH=f5a090037ba4cc92c3a87e4744e66003
BOT_TOKEN=8039358878:AAGg38C2-wuqTGzSw8XVTVGC9sRG6gHHTO8
OWNER_ID=7619316793
OWNER_USERNAME=Sexuatic
OWNER_SECRET_PASSWORD=fiVe55@@
DEFAULT_AUDIO_QUALITY=320
ENABLE_INLINE_MODE=True
ENABLE_VOICE_RECOGNITION=True
ENABLE_LYRICS=True
ENABLE_BROADCAST=True
```

# Step 5: Running the Bot

## Method 1: Double-click run.bat (Easiest)
- Navigate to the project folder
- Double-click `run.bat`
- The bot will install dependencies and start

## Method 2: Using PowerShell
```
cd "C:\path\to\MusicStreamer"
python -m pip install -r requirements.txt
python bot.py
```

## Method 3: Using Command Prompt (cmd)
```
cd "C:\path\to\MusicStreamer"
python -m pip install -r requirements.txt
python bot.py
```

# Step 6: First Time Setup

1. Bot will check all dependencies
2. Creates necessary folders (downloads, cache, temp, logs)
3. Validates credentials
4. Connects to Telegram

When successful, you'll see:
```
âœ… BOT STARTED SUCCESSFULLY!
ðŸ“± Bot Username: @YourBotUsername
```

# Step 7: Owner Authentication

1. Message the bot: `/auth fiVe55@@`
2. You'll get access to all owner commands

# TROUBLESHOOTING COMMON WINDOWS ISSUES

## Issue: "Python is not recognized"
Solution:
- Reinstall Python and CHECK "Add Python to PATH"
- Or manually add Python to PATH:
  - Find: C:\Users\YourUsername\AppData\Local\Programs\Python\Python311
  - Add to Windows PATH environment variable

## Issue: "pip not found"
Solution:
- Run: `python -m pip --upgrade pip`
- Run: `python -m pip install -r requirements.txt`

## Issue: "FFmpeg not found"
Solution:
- Install FFmpeg (see Step 2)
- Verify: Open cmd, type `ffmpeg -version`
- Should show version info

## Issue: "TgCrypto error" on Windows
Solution:
- Install Visual C++ Build Tools:
  https://visualstudio.microsoft.com/visual-cpp-build-tools/
- Then run: `pip install TgCrypto --no-cache-dir`

## Issue: "Port already in use" / "Address already in use"
Solution:
- Only one instance of bot can run
- Close other Python processes:
  1. Press Ctrl+Shift+Esc (Task Manager)
  2. Find "python.exe"
  3. Right-click â†’ End Task

## Issue: Bot crashes or disconnects
Solution:
- Check logs in `logs/bot.log`
- Ensure internet connection is stable
- Verify API credentials are correct
- Try running with: `python bot.py --debug`

## Issue: "Access Denied" when creating folders
Solution:
- Run Command Prompt as Administrator
- Or change project folder to Documents/Desktop

## Issue: Audio files not downloading
Solution:
- Verify FFmpeg is installed
- Check available disk space (need at least 1GB)
- Check bot permissions
- Try simpler songs first

# ADVANCED OWNER COMMANDS (After /auth)

```
System Info:
- /sysinfo - System details
- /sysstats - Detailed stats
- /meminfo - Memory info
- /netinfo - Network info
- /perfstats - Performance stats
- /processes - Running processes

File Management:
- /cleanup - Clean temp files
- /cleardownloads - Clear downloads
- /clearlogs - Clear logs
- /logstats - Log statistics
- /dirsize - Directory sizes

User Management:
- /getuser <id> - Get user info
- /banuser <id> - Ban user
- /unbanuser <id> - Unban user
- /sendmsg <id> <msg> - Send message
- /authlist - List authenticated users
- /logout - Logout from session

Code Execution (Use with caution):
- /eval <code> - Execute Python code
- /shell <command> - Execute shell command

Broadcast & Stats:
- /broadcast <msg> - Send to all users
- /stats - Bot statistics
- /dbstats - Database statistics

Bot Control:
- /restart - Restart bot
- /ownerhelp - Show all commands
```

# KEEPING THE BOT RUNNING 24/7

## Option 1: Windows Task Scheduler
1. Open Task Scheduler
2. Create Basic Task
3. Set trigger (On startup or repeated)
4. Set action: Start program â†’ bot.py
5. Check "Run with highest privileges"

## Option 2: Using NSSM (Non-Sucking Service Manager)
```
Download from: https://nssm.cc/download
nssm install MusicBot "C:\Python311\python.exe" "C:\path\to\bot.py"
nssm start MusicBot
```

## Option 3: Docker (Advanced)
- Use Docker to containerize the bot
- Ensure you have Docker installed for Windows

# PERFORMANCE TIPS

1. Close unnecessary programs (Firefox, Chrome, etc.)
2. Use quality 192-256kbps for faster downloads
3. Monitor system resources: /perfstats
4. Clean up regularly: /cleanup
5. Keep Windows updated

# GETTING HELP

1. Check logs: `logs/bot.log`
2. Run diagnostics: /sysinfo, /sysstats
3. Verify credentials in config.py
4. Check internet connection
5. Reinstall requirements: `pip install -r requirements.txt --force-reinstall`

# UPDATING THE BOT

```
git pull origin main
pip install -r requirements.txt --upgrade
python bot.py
```

Or manually download the latest files and run run.bat

---

**Support**: Contact @Sexuatic on Telegram
**Issues**: Check logs and use /sysinfo for diagnostics
**Last Updated**: October 16, 2025
